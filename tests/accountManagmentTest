<?php
use PHPUnit\Framework\TestCase;

/**
 * Admin Dashboard & User Management
 * User Story: "As an admin, I can manage users and products through the admin panel"
 */
final class Feature_Admin_ManagementTest extends TestCase
{
    protected function tearDown(): void
    {
        reset_session_flash();
        unset($_SESSION['user_id'], $_SESSION['user_role']);
    }

    public function testAdminRoleRequirements(): void
    {
        // Clear and initialize session
        $_SESSION = [];
        
        // Test admin access control
        $_SESSION['user_role'] = 'admin';
        $this->assertTrue(hasRole(['admin']), 'hasRole should return true for admin');
        $this->assertTrue(isAdmin(), 'isAdmin should return true for admin role');
        
        $_SESSION['user_role'] = 'staff';
        $this->assertTrue(hasRole(['admin', 'staff']), 'hasRole should return true for staff in admin/staff array');
        $this->assertFalse(isAdmin(), 'isAdmin should return false for staff role');
        $this->assertTrue(isStaff(), 'isStaff should return true for staff role');
        
        $_SESSION['user_role'] = 'customer';
        $this->assertFalse(hasRole(['admin']), 'hasRole should return false for customer with admin requirement');
        $this->assertFalse(isAdmin(), 'isAdmin should return false for customer role');
        $this->assertFalse(isStaff(), 'isStaff should return false for customer role');
    }
}